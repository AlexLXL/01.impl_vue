{"version":3,"file":"vue.js","sources":["../../src/utils.js","../../src/observe/array.js","../../src/observe/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["export function isFunction(val) {\r\n    return typeof val === \"function\";\r\n}\r\n\r\nexport function isObject(val) {\r\n    return typeof val === \"object\" && val !== null;\r\n}\r\n\r\nexport function isArray(val) {\r\n    return Array.isArray(val);\r\n}","let oldArrayPrototype = Array.prototype;\r\n\r\nexport let arrayMethods = Object.create(oldArrayPrototype);\r\n\r\nlet methods = [\"push\", \"shift\", \"pop\", \"unshift\", \"reverse\", \"sort\", \"splice\"];\r\n\r\nmethods.forEach((method) => {\r\n    arrayMethods[method] = function(){\r\n        console.log(\"数组方法进行了重写操作\")\r\n    }\r\n})","import {isArray, isObject} from \"../utils\";\r\nimport {arrayMethods} from \"./array\";\r\n\r\nexport function observe(value) {\r\n    if (!isObject(value)) return;\r\n\r\n    return new Observer(value);\r\n}\r\n\r\nclass Observer {\r\n    constructor(value) {\r\n        if (isArray(value)) {\r\n            value.__proto__ = arrayMethods;\r\n        }else {\r\n            this.walk(value);\r\n        }\r\n    }\r\n\r\n    walk(data) {\r\n        Object.keys(data).forEach((key) => {\r\n            defineReactive(data, key, data[key]);\r\n        })\r\n    }\r\n}\r\n\r\nfunction defineReactive(obj, key, value) {\r\n    observe(value); // 递归监控value\r\n\r\n    Object.defineProperty(obj, key, {\r\n        get() {\r\n            return value;\r\n        },\r\n        set(newValue) {\r\n            if (newValue === oldValue) return;\r\n            value = newValue;\r\n        }\r\n    })\r\n}","import {isFunction} from \"./utils\";\r\nimport {observe} from \"./observe/index.js\";\r\n\r\nexport function initState(vm) {\r\n    const opts = vm.$options;\r\n    \r\n    if (opts.data) {\r\n        initData(vm)\r\n    }\r\n}\r\n\r\nfunction initData(vm) {\r\n    let data = vm.$options.data;\r\n    data = vm._data = isFunction(data) ? data.call(vm) : data;\r\n    observe(data);\r\n    \r\n    for (let key in data) {\r\n        proxy(vm, key, \"_data\");\r\n    }\r\n    \r\n    console.log(data);\r\n    data.arr.push(3);\r\n    console.log(vm.arr);\r\n}\r\n\r\nfunction proxy(vm, key, source) {\r\n    Object.defineProperty(vm, key, {\r\n        get() {\r\n            return vm[source][key];\r\n        },\r\n        set(newValue) {\r\n            vm[source][key] = newValue;\r\n        }\r\n    })\r\n}","import {initState} from \"./state\";\r\n\r\nexport function initMixin(Vue) {\r\n    Vue.prototype._init = function (options) {\r\n        const vm = this;\r\n        vm.$options = options;\r\n\r\n        initState(vm);\r\n\r\n        if (vm.$options.el) {\r\n            // --snip-- 挂载\r\n        }\r\n    }\r\n}\r\n","import {initMixin} from \"./init\";\r\n\r\nfunction Vue(option) {\r\n    this._init(option);\r\n}\r\n\r\ninitMixin(Vue);\r\n\r\nexport default Vue;\r\n"],"names":["isFunction","val","isObject","isArray","Array","oldArrayPrototype","prototype","arrayMethods","Object","create","methods","forEach","method","console","log","observe","value","Observer","constructor","__proto__","walk","data","keys","key","defineReactive","obj","defineProperty","get","set","newValue","oldValue","initState","vm","opts","$options","initData","_data","call","proxy","arr","push","source","initMixin","Vue","_init","options","el","option"],"mappings":";;;;;;IAAO,SAASA,UAAT,CAAoBC,GAApB,EAAyB;IAC5B,SAAO,OAAOA,GAAP,KAAe,UAAtB;IACH;IAEM,SAASC,QAAT,CAAkBD,GAAlB,EAAuB;IAC1B,SAAO,OAAOA,GAAP,KAAe,QAAf,IAA2BA,GAAG,KAAK,IAA1C;IACH;IAEM,SAASE,OAAT,CAAiBF,GAAjB,EAAsB;IACzB,SAAOG,KAAK,CAACD,OAAN,CAAcF,GAAd,CAAP;IACH;;ICVD,IAAII,iBAAiB,GAAGD,KAAK,CAACE,SAA9B;IAEO,IAAIC,YAAY,GAAGC,MAAM,CAACC,MAAP,CAAcJ,iBAAd,CAAnB;IAEP,IAAIK,OAAO,GAAG,CAAC,MAAD,EAAS,OAAT,EAAkB,KAAlB,EAAyB,SAAzB,EAAoC,SAApC,EAA+C,MAA/C,EAAuD,QAAvD,CAAd;IAEAA,OAAO,CAACC,OAAR,CAAiBC,MAAD,IAAY;IACxBL,EAAAA,YAAY,CAACK,MAAD,CAAZ,GAAuB,YAAU;IAC7BC,IAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;IACH,GAFD;IAGH,CAJD;;ICHO,SAASC,OAAT,CAAiBC,KAAjB,EAAwB;IAC3B,MAAI,CAACd,QAAQ,CAACc,KAAD,CAAb,EAAsB;IAEtB,SAAO,IAAIC,QAAJ,CAAaD,KAAb,CAAP;IACH;;IAED,MAAMC,QAAN,CAAe;IACXC,EAAAA,WAAW,CAACF,KAAD,EAAQ;IACf,QAAIb,OAAO,CAACa,KAAD,CAAX,EAAoB;IAChBA,MAAAA,KAAK,CAACG,SAAN,GAAkBZ,YAAlB;IACH,KAFD,MAEM;IACF,WAAKa,IAAL,CAAUJ,KAAV;IACH;IACJ;;IAEDI,EAAAA,IAAI,CAACC,IAAD,EAAO;IACPb,IAAAA,MAAM,CAACc,IAAP,CAAYD,IAAZ,EAAkBV,OAAlB,CAA2BY,GAAD,IAAS;IAC/BC,MAAAA,cAAc,CAACH,IAAD,EAAOE,GAAP,EAAYF,IAAI,CAACE,GAAD,CAAhB,CAAd;IACH,KAFD;IAGH;;IAbU;;IAgBf,SAASC,cAAT,CAAwBC,GAAxB,EAA6BF,GAA7B,EAAkCP,KAAlC,EAAyC;IACrCD,EAAAA,OAAO,CAACC,KAAD,CAAP,CADqC;;IAGrCR,EAAAA,MAAM,CAACkB,cAAP,CAAsBD,GAAtB,EAA2BF,GAA3B,EAAgC;IAC5BI,IAAAA,GAAG,GAAG;IACF,aAAOX,KAAP;IACH,KAH2B;;IAI5BY,IAAAA,GAAG,CAACC,QAAD,EAAW;IACV,UAAIA,QAAQ,KAAKC,QAAjB,EAA2B;IAC3Bd,MAAAA,KAAK,GAAGa,QAAR;IACH;;IAP2B,GAAhC;IASH;;IClCM,SAASE,SAAT,CAAmBC,EAAnB,EAAuB;IAC1B,QAAMC,IAAI,GAAGD,EAAE,CAACE,QAAhB;;IAEA,MAAID,IAAI,CAACZ,IAAT,EAAe;IACXc,IAAAA,QAAQ,CAACH,EAAD,CAAR;IACH;IACJ;;IAED,SAASG,QAAT,CAAkBH,EAAlB,EAAsB;IAClB,MAAIX,IAAI,GAAGW,EAAE,CAACE,QAAH,CAAYb,IAAvB;IACAA,EAAAA,IAAI,GAAGW,EAAE,CAACI,KAAH,GAAWpC,UAAU,CAACqB,IAAD,CAAV,GAAmBA,IAAI,CAACgB,IAAL,CAAUL,EAAV,CAAnB,GAAmCX,IAArD;IACAN,EAAAA,OAAO,CAACM,IAAD,CAAP;;IAEA,OAAK,IAAIE,GAAT,IAAgBF,IAAhB,EAAsB;IAClBiB,IAAAA,KAAK,CAACN,EAAD,EAAKT,GAAL,EAAU,OAAV,CAAL;IACH;;IAEDV,EAAAA,OAAO,CAACC,GAAR,CAAYO,IAAZ;IACAA,EAAAA,IAAI,CAACkB,GAAL,CAASC,IAAT,CAAc,CAAd;IACA3B,EAAAA,OAAO,CAACC,GAAR,CAAYkB,EAAE,CAACO,GAAf;IACH;;IAED,SAASD,KAAT,CAAeN,EAAf,EAAmBT,GAAnB,EAAwBkB,MAAxB,EAAgC;IAC5BjC,EAAAA,MAAM,CAACkB,cAAP,CAAsBM,EAAtB,EAA0BT,GAA1B,EAA+B;IAC3BI,IAAAA,GAAG,GAAG;IACF,aAAOK,EAAE,CAACS,MAAD,CAAF,CAAWlB,GAAX,CAAP;IACH,KAH0B;;IAI3BK,IAAAA,GAAG,CAACC,QAAD,EAAW;IACVG,MAAAA,EAAE,CAACS,MAAD,CAAF,CAAWlB,GAAX,IAAkBM,QAAlB;IACH;;IAN0B,GAA/B;IAQH;;IChCM,SAASa,SAAT,CAAmBC,GAAnB,EAAwB;IAC3BA,EAAAA,GAAG,CAACrC,SAAJ,CAAcsC,KAAd,GAAsB,UAAUC,OAAV,EAAmB;IACrC,UAAMb,EAAE,GAAG,IAAX;IACAA,IAAAA,EAAE,CAACE,QAAH,GAAcW,OAAd;IAEAd,IAAAA,SAAS,CAACC,EAAD,CAAT;;IAEA,QAAIA,EAAE,CAACE,QAAH,CAAYY,EAAhB,EAAoB;IAGvB,GATD;IAUH;;ICXD,SAASH,GAAT,CAAaI,MAAb,EAAqB;IACjB,OAAKH,KAAL,CAAWG,MAAX;IACH;;IAEDL,SAAS,CAACC,GAAD,CAAT;;;;;;;;"}