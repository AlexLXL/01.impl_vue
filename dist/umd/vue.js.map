{"version":3,"file":"vue.js","sources":["../../src/utils.js","../../src/observe/array.js","../../src/observe/index.js","../../src/state.js","../../src/compiler/parser.js","../../src/compiler/generate.js","../../src/compiler/index.js","../../src/init.js","../../src/index.js"],"sourcesContent":["export function isFunction(val) {\r\n    return typeof val === \"function\";\r\n}\r\n\r\nexport function isObject(val) {\r\n    return typeof val === \"object\" && val !== null;\r\n}\r\n\r\nexport function isArray(val) {\r\n    return Array.isArray(val);\r\n}","let oldArrayPrototype = Array.prototype;\r\n\r\nexport let arrayMethods = Object.create(oldArrayPrototype);\r\n\r\nlet methods = [\"push\", \"shift\", \"pop\", \"unshift\", \"reverse\", \"sort\", \"splice\"];\r\n\r\nmethods.forEach((method) => {\r\n    arrayMethods[method] = function(...args){\r\n        oldArrayPrototype[method].call(this, ...args);\r\n\r\n        // 监控新增的值\r\n        let inserted = null;\r\n        let ob = this.__ob__;\r\n        switch (method) {\r\n            case \"splice\":\r\n                inserted = args.slice(2);\r\n            case \"push\":\r\n            case \"unshift\":\r\n                inserted = args;\r\n                break;\r\n        }\r\n        if (inserted) ob.observeArray(inserted);\r\n    }\r\n})","import {isArray, isObject} from \"../utils\";\r\nimport {arrayMethods} from \"./array\";\r\n\r\nexport function observe(value) {\r\n    if (value.__ob__) return;\r\n    if (!isObject(value)) return;\r\n\r\n    return new Observer(value);\r\n}\r\n\r\nclass Observer {\r\n    constructor(value) {\r\n        Object.defineProperty(value, \"__ob__\", {\r\n            value: this,\r\n            enumerable: false\r\n        })\r\n\r\n        if (isArray(value)) {\r\n            value.__proto__ = arrayMethods;\r\n            this.observeArray(value);\r\n        }else {\r\n            this.walk(value);\r\n        }\r\n    }\r\n\r\n    walk(data) {\r\n        // 监控对象\r\n        Object.keys(data).forEach((key) => {\r\n            defineReactive(data, key, data[key]);\r\n        })\r\n    }\r\n\r\n    observeArray(data) {\r\n        // 监控数组\r\n        data.forEach((item) => observe(item)); // 数组内的引用类型添加监控，[[], {}]\r\n    }\r\n}\r\n\r\nfunction defineReactive(obj, key, value) {\r\n    observe(value); // 递归监控value\r\n\r\n    Object.defineProperty(obj, key, {\r\n        get() {\r\n            return value;\r\n        },\r\n        set(newValue) {\r\n            if (newValue === value) return;\r\n            observe(newValue); // 新值加监控\r\n            value = newValue;\r\n        }\r\n    })\r\n}","import {isFunction} from \"./utils\";\r\nimport {observe} from \"./observe/index.js\";\r\n\r\nexport function initState(vm) {\r\n    const opts = vm.$options;\r\n    \r\n    if (opts.data) {\r\n        initData(vm)\r\n    }\r\n}\r\n\r\nfunction initData(vm) {\r\n    let data = vm.$options.data;\r\n    data = vm._data = isFunction(data) ? data.call(vm) : data;\r\n    observe(data);\r\n    \r\n    for (let key in data) {\r\n        proxy(vm, key, \"_data\");\r\n    }\r\n    \r\n    console.log(\"添加监控后data:\", data);\r\n    // data.arr.push(3);\r\n    // console.log(vm.arr);\r\n    // vm.arr[1].push(3);\r\n    // vm.name = {a: 2};\r\n    // vm.name.a = 20;\r\n    // vm.arr.push({a: 100});\r\n    // vm.arr[3].a = 200;\r\n}\r\n\r\nfunction proxy(vm, key, source) {\r\n    Object.defineProperty(vm, key, {\r\n        get() {\r\n            return vm[source][key];\r\n        },\r\n        set(newValue) {\r\n            vm[source][key] = newValue;\r\n        }\r\n    })\r\n}","// 用\"html\".match(new RegExp(ncname))匹配\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // 匹配标签名，子模块aaa-bbb\r\n/*[\r\n    0: \"aa-bb\"\r\n    groups: undefined\r\n    index: 1\r\n    input: \"<aa-bb>2131</aa-bb>>\"\r\n    length: 1\r\n]*/\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; // 命名空间标签，aa:aa-xxx。很少用\r\n/*[\r\n    0: \"aa-bb\"\r\n    1: \"aa-bb\"\r\n    groups: undefined\r\n    index: 1\r\n    input: \"<aa-bb>2131</aa-bb>>\"\r\n    length: 2\r\n]*/\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 匹配<标签名和标签名，0: <aa:aa-xxx或<aa-aa, 1: aa:aa-xxx或aa-aa\r\n/*[\r\n    0: \"<aa-bb\"\r\n    1: \"aa-bb\"\r\n    groups: undefined\r\n    index: 0\r\n    input: \"<aa-bb>2131</aa-bb>\"\r\n    length: 2\r\n]*/\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性, 见下\r\n/*{\r\n    0: \"title = 123\"    // 完整字符串\r\n    1: \"title\"      // key\r\n    2: \"=\"          // 等号\r\n    3: undefined    // 双引号\r\n    4: undefined    // 单引号\r\n    5: \"123\"        // 无引号\r\n    groups: undefined\r\n    index: 0\r\n    input: \"title = 123></aa-bb>\"\r\n    length: 6\r\n}*/\r\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束, >或/>\r\n/*{\r\n    0: \"/>\"\r\n    1: \"/\"\r\n    groups: undefined\r\n    index: 0\r\n    input: \"/>32323\"\r\n    length: 2\r\n}*/\r\n// const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; // // 匹配文本, {{message}}\r\n/*{\r\n    0: \"{{message}}\"\r\n    length: 1\r\n}*/\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结束 0: </aa-bb>, 1: aa-bb\r\n/*{\r\n    0: \"</aa-bb>\"\r\n    1: \"aa-bb\"\r\n    groups: undefined\r\n    index: 0\r\n    input: \"</aa-bb>\"\r\n    length: 2\r\n}*/\r\n\r\n// 生成ast树\r\nexport function parserHTML(html) {\r\n    let stack = [];\r\n    let root = null;\r\n    function start(tagName, attrs) {\r\n        let parent = stack[stack.length - 1];\r\n        let element = createASTElement(tagName, attrs, parent);\r\n        if (root === null) {\r\n            root = element;\r\n        }\r\n\r\n        if (parent) {\r\n            element.parent = parent;\r\n            parent.children.push(element);\r\n        }\r\n\r\n        stack.push(element);\r\n    }\r\n    function text(chars) {\r\n        let parent = stack[stack.length - 1];\r\n        chars.replace(/\\s/g, \"\"); // 替换空格\r\n        if(chars) {\r\n            parent.children.push({\r\n                type: 2,\r\n                text:chars\r\n            })\r\n        }\r\n    }\r\n    function end(tagName) {\r\n        let endTag = stack.pop();\r\n        if(endTag.tag != tagName) {\r\n            console.log(\"标签出错\");\r\n        }\r\n    }\r\n    function advance(len) {\r\n        html = html.substring(len);\r\n    }\r\n    function parseStartTag() {\r\n        const start = html.match(startTagOpen);\r\n        if (start) {\r\n            // 匹配到开始标签\r\n            const match = {\r\n                tagName: start[1],\r\n                attrs: []\r\n            }\r\n            advance(start[0].length);\r\n\r\n            // 匹配属性\r\n            let end,\r\n                attr\r\n            while(!(end = html.match(startTagClose)) && (attr = html.match(attribute))) { // 顺序不能反\r\n                match.attrs.push({\r\n                    name: attr[1],\r\n                    value: attr[3] || attr[4] || attr[5]\r\n                })\r\n                advance(attr[0].length);\r\n            }\r\n            if (end) {\r\n                advance(end[0].length)\r\n            }\r\n\r\n            return match;\r\n            /*\r\n            {\r\n                tagName: div,\r\n                attrs: [\r\n                    {title: 123}\r\n                ]\r\n            }\r\n            */\r\n        }\r\n        return false;\r\n    }\r\n    function createASTElement(tag, attrs, parent) {\r\n        return {\r\n            tag,\r\n            attrs,\r\n            parent,\r\n            type: 1,\r\n            children: []\r\n        }\r\n    }\r\n\r\n    while(html) {\r\n        let index = html.indexOf(\"<\");\r\n        if (index === 0) {\r\n            // 开始标签\r\n            const startTagMatch = parseStartTag(html); // 拿到开始标签的名称和属性，开始构建ast\r\n            if (startTagMatch) {\r\n                start(startTagMatch.tagName, startTagMatch.attrs);\r\n                continue;\r\n            }\r\n            // 结束标签\r\n            let endTagMatch\r\n            if(endTagMatch = html.match(endTag)) {\r\n                end(endTagMatch[1]);\r\n                advance(endTagMatch[0].length)\r\n                continue;\r\n            }\r\n            break;\r\n        }\r\n        // 文本\r\n        if (index > 0) {\r\n            let chars = html.substring(0, index);\r\n            text(chars);\r\n            advance(chars.length);\r\n        }\r\n    }\r\n\r\n    return root;\r\n}","let defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; // 匹配文本, {{message}}\r\n/*{\r\n    0: \"{{message}}\"\r\n    length: 1\r\n}*/\r\n\r\nexport function generate(ast) {\r\n    // 2.处理子组件\r\n    let children = genChildren(ast);\r\n\r\n    // 1.处理第一层div\r\n    let code =\r\n        `_c(\"${ast.tag}\",\r\n            ${\r\n                ast.attrs.length ? genProps(ast.attrs) : \"undefined\"\r\n            }\r\n            ${\r\n                children ? `,[${children}]` : \"\"\r\n            }\r\n        )`;\r\n    return code\r\n}\r\n\r\nfunction genChildren(el) {\r\n    let children = el.children;\r\n    if (children) {\r\n        // 要分类讨论，1.普通文本 2.{{文本}} 3.子标签span/div\r\n        return children.map(item => gen(item)).join(\",\");\r\n    }\r\n    return false\r\n}\r\n\r\nfunction gen(el) {\r\n    if (el.type == 1) {\r\n        // 3.子标签span/div\r\n        return generate(el);\r\n    }else {\r\n        // 1.只有普通文本\r\n        let text = el.text;\r\n        if (!defaultTagRE.test(text)) return `_v(\"${text}\")`;\r\n        defaultTagRE.lastIndex = 0; // ★ /g正则调用test()和exec()lastIndex都会往后\r\n\r\n        //  2.普通文本 + {{文本}}\r\n        let lastIndex = 0;\r\n        let tokens = [];\r\n        let match;\r\n        while(match = defaultTagRE.exec(text)) {\r\n            // ★ exec和正则的/g要注意，/g会让 defaultTagRE的lastIndex 往后一位\r\n            // 如<p>aa {{bb}} cc {{dd}}</p>\r\n            // 第一次是匹配到aa {{bb}}\r\n            let index = match.index;\r\n            if (index > lastIndex) {\r\n                tokens.push(JSON.stringify(text.slice(lastIndex, index)));\r\n            }\r\n            tokens.push(`_s(${match[1].trim()})`);  // 1 -- name\r\n            lastIndex = index + match[0].length;    // 0 -- {{name}}\r\n        }\r\n        if (lastIndex < text.length) { // 匹配最后的普通文本bb， aa {{name}} bb\r\n            tokens.push(JSON.stringify(text.slice(lastIndex)));\r\n        }\r\n\r\n        return `_v(${tokens.join(\" + \")})`\r\n    }\r\n}\r\n\r\n\r\n\r\n/**\r\n * 生成属性字符串\r\n * @param attrs\r\n * @returns {string} 返回 {id:\"app\",style:{\"font-size\":\"18px\",\"color\":\"#ccc\"}}\r\n */\r\nfunction genProps(attrs) {\r\n    let str = \"\";\r\n\r\n    for (let i = 0; i < attrs.length; i++) {\r\n        let attr = attrs[i];\r\n        if (attr.name === \"style\") {\r\n            let styles = {}\r\n            attr.value.replace(/([^;:]+):([^;:]+)/g, function (...args) {\r\n                styles[args[1].trim()] = args[2].trim();\r\n            })\r\n            attr.value = styles;\r\n        }\r\n        str += `${attr.name}:${JSON.stringify(attr.value)},`\r\n    }\r\n\r\n    return `{${str.slice(0, -1)}}`;\r\n}\r\n/*\r\n* replace方法返回的arcgument\r\n* {\r\n*   0: \"color:123\"\r\n*   1: \"color\"\r\n*   2: \"123\"\r\n*   3: 0\r\n*   4: \"color:123;color:123\"\r\n*   length: 5\r\n* }\r\n*\r\n* */\r\n\r\n\r\n","import {parserHTML} from \"./parser\";\r\nimport {generate} from \"./generate\";\r\n\r\nexport function compilerToFunction(template) {\r\n    console.log(\"template:\", template);\r\n\r\n    let ast = parserHTML(template);\r\n    console.log(\"ast:\", ast);\r\n\r\n    let code = generate(ast);\r\n    console.log(\"code:\", code);\r\n\r\n    let render = new Function(`with(this) {return ${code}}`);\r\n    console.log(\"render:\", render.toString());\r\n}\r\n\r\n/*\r\n示例:AST格式\r\n\r\n{\r\nparent: undefined\r\ntag: \"div\"\r\ntype: 1\r\nattrs: Array(2)\r\n    0: {name: \"id\", value: \"app\"}\r\n    1: {name: \"style\", value: \"font-size: 18px; color: #ccc\"}\r\n    length: 2\r\n    __proto__: Array(0)\r\nchildren: Array(2)\r\n    0: {type: 2, text: \" aa {{name}} bb \"}\r\n    1: {tag: \"span\", attrs: Array(0), parent: {…}, type: 1, children: Array(1)}\r\n    length: 2\r\n    __proto__: Array(0)\r\n}\r\n*/","import {initState} from \"./state\";\r\nimport {compilerToFunction} from \"./compiler\";\r\n\r\nexport function initMixin(Vue) {\r\n    Vue.prototype._init = function (options) {\r\n        const vm = this;\r\n        vm.$options = options;\r\n\r\n        initState(vm);\r\n\r\n        if (vm.$options.el) {\r\n            vm.$mount(vm.$options.el);\r\n        }\r\n    }\r\n\r\n    Vue.prototype.$mount = function (el) {\r\n        const vm = this;\r\n        const opts = vm.$options;\r\n        el = document.querySelector(el);\r\n        vm.$el = el;\r\n\r\n        if (!opts.render) {\r\n            let template = opts.template;\r\n            if (!opts.template) {\r\n                template = el.outerHTML;\r\n            }\r\n            let render = compilerToFunction(template);\r\n            opts.render = render;\r\n        }\r\n    }\r\n}\r\n\r\n/*\r\n示例:render函数\r\n\r\nfunction render() {\r\n  with(this) {\r\n    return _c('div', {\r\n      attrs: {\r\n        \"id\": \"app\"\r\n      }\r\n    }, [_v(\"aa \" + _s(msg) + \" cc \"), _c('p', [_v(\"cc\")])])\r\n  }\r\n}\r\n*/\r\n","import {initMixin} from \"./init\";\r\n\r\nfunction Vue(option) {\r\n    this._init(option);\r\n}\r\n\r\ninitMixin(Vue);\r\n\r\nexport default Vue;\r\n"],"names":["isFunction","val","isObject","isArray","Array","oldArrayPrototype","prototype","arrayMethods","Object","create","methods","forEach","method","args","call","inserted","ob","__ob__","slice","observeArray","observe","value","Observer","constructor","defineProperty","enumerable","__proto__","walk","data","keys","key","defineReactive","item","obj","get","set","newValue","initState","vm","opts","$options","initData","_data","proxy","console","log","source","ncname","qnameCapture","startTagOpen","RegExp","attribute","startTagClose","endTag","parserHTML","html","stack","root","start","tagName","attrs","parent","length","element","createASTElement","children","push","text","chars","replace","type","end","pop","tag","advance","len","substring","parseStartTag","match","attr","name","index","indexOf","startTagMatch","endTagMatch","defaultTagRE","generate","ast","genChildren","code","genProps","el","map","gen","join","test","lastIndex","tokens","exec","JSON","stringify","trim","str","i","styles","compilerToFunction","template","render","Function","toString","initMixin","Vue","_init","options","$mount","document","querySelector","$el","outerHTML","option"],"mappings":"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"}